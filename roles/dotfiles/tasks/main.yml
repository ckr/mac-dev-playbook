---
- name: Copy dotfiles
  ansible.builtin.copy:
    src: "{{ item }}"
    dest: "{{ ansible_user_dir }}/.{{ item | basename }}"
    mode: u+rwx,go+rx
  with_fileglob:
    - "./dotfiles/*"
  tags:
    - files
    - dotaliases

- name: Ensure bin/ folder exists
  ansible.builtin.file:
    path: "{{ ansible_user_dir }}/bin"
    state: directory
    mode: u+rwx,go+rx
  tags:
    - folders

- name: Ensure ~/work folder exists
  ansible.builtin.file:
    path: "{{ ansible_user_dir }}/work"
    state: directory
    mode: u+rwx,go+rx
  tags:
    - folders

- name: Ensure ~/code folder exists
  ansible.builtin.file:
    path: "{{ ansible_user_dir }}/code"
    state: directory
    mode: u+rwx,go+rx
  tags:
    - folders

- name: Copy bin/ files
  ansible.builtin.copy:
    src: "{{ item }}"
    dest: "{{ ansible_user_dir }}/bin/{{ item | basename }}"
    mode: ug+rwx,o+rx
  with_fileglob:
    - "./bin/*"
  tags:
    - files
    - binfile

- name: Copy dotfiles files with template
  ansible.builtin.template:
    src: path_exports.j2
    dest: "{{ ansible_user_dir }}/.path_exports"
    mode: u+rwx,go+rx
  tags:
    - files
    - dotaliases
