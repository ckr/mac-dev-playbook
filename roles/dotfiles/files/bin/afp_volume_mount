#!/bin/bash

set -e

if [ $# -eq 0 ]; then
	echo "No arguments supplied"
	echo "usage is: user server volumeName"
	exit 1
fi

if [ -z "$1" ]; then
	echo "User name cannot be empty"
	exit 1
fi

user=$1

if [ -z "$2" ]; then
	echo "Server cannot be empty"
	exit 1
fi

server=$2

if [ -z "$3" ]; then
	echo "Volume name cannot be empty"
	exit 1
fi

volumeName=$3

if mount | grep "on /Volumes/$volumeName" > /dev/null; then
	echo "Volume $volumeName is mounted."
	echo "Exiting..."
else
	echo "Volume $volumeName is not mounted."
	echo "Attempting to mount..."
	/usr/bin/osascript -e 'display notification "Mounting 'afp://"${user}"@"${server}"/"${volumeName//\"/}"'"'
	/usr/bin/osascript -e 'mount volume "'afp://"${user}"@"${server}"/"${volumeName//\"/}"'"'
fi
